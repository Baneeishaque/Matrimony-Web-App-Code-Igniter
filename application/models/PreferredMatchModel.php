<?php

class PreferredMatchModel extends CI_Model
{
	function __construct()
	{
		parent::__construct();

		$this->load->database();
		$this->load->helper('text');
	}

	function getPreferences($userId)
	{
//		Kint::dump($userId);
//		exit(0);
		$query = $this->db->query("SELECT * FROM `partner_prefferences` WHERE `partner_prefferences`.`web_id`='" . $userId . "'");
//		echo $this->db->last_query();
//		exit(0);
		return $query->result();
	}

	function getMatchesLevel2($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId, $userIncomeId, $userComplexionId, $userBodyTypeId, $userFamilyStatusId, $userCountryId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' 
  AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') 
  AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') 
  AND `register`.`religion_id` = '$userReligionId' 
  AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') 
  AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') 
  AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') 
  AND `register`.`p_state_id` = '$userStateId' 
  AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') 
  AND `register`.`income_id` = '$userIncomeId' 
  AND `register`.`complexion_id` IN ('" . str_replace_last(",", "", $userComplexionId) . "') 
  AND `register`.`body_type_id` IN ('" . str_replace_last(",", "", $userBodyTypeId) . "') 
  AND `register`.`family_status_id` IN ('" . str_replace_last(",", "", $userFamilyStatusId) . "') 
  AND `register`.`p_country_id` = '$userCountryId' 
  AND `register`.`web_id` = `users`.`id` 
  AND `register`.`p_state_id` = `states`.`id` 
  AND `register`.`religion_id` = `religion`.`religion_id` 
  AND `register`.`p_country_id` = `country`.`id` 
  AND `register`.`income_id` = `income`.`income_id` 
  AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` 
  AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` 
  AND `register`.`jobtitle_id` = `job`.`job_id` 
  AND `register`.`highest_education_id` = `education`.`education_id` 
  AND `register`.`p_district_id` = `districts`.`id` 
  AND `register`.`complexion_id` = `complexion`.`complexion_id` 
  AND `register`.`body_type_id` = `body_type`.`body_type_id` 
  AND `register`.`family_status_id` = `family_status`.`family_status_id` 
  AND `register`.`cast_id` = `cast`.`cast_id` 
  AND `documents`.`web_id` = `users`.`id` 
  AND `documents`.`type`= 'profile_photo' 
  AND `customer_package`.`web_id` = `users`.`id` 
  AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel3($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId, $userIncomeId, $userComplexionId, $userBodyTypeId, $userFamilyStatusId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') AND `register`.`income_id` = '$userIncomeId' AND `register`.`complexion_id` IN ('" . str_replace_last(",", "", $userComplexionId) . "') AND `register`.`body_type_id` IN ('" . str_replace_last(",", "", $userBodyTypeId) . "') AND `register`.`family_status_id` IN ('" . str_replace_last(",", "", $userFamilyStatusId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
//		echo $this->db->last_query();
//		exit(0);
		return $query->result();
	}

	function getMatchesLevel4($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId, $userIncomeId, $userComplexionId, $userBodyTypeId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') AND `register`.`income_id` = '$userIncomeId' AND `register`.`complexion_id` IN ('" . str_replace_last(",", "", $userComplexionId) . "') AND `register`.`body_type_id` IN ('" . str_replace_last(",", "", $userBodyTypeId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel5($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId, $userIncomeId, $userComplexionId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') AND `register`.`income_id` = '$userIncomeId' AND `register`.`complexion_id` IN ('" . str_replace_last(",", "", $userComplexionId) . "')AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel6($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId, $userIncomeId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') AND `register`.`income_id` = '$userIncomeId' AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel7($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId, $userDistrictId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`p_district_id` IN ('" . str_replace_last(",", "", $userDistrictId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel8($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId, $userStateId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`p_state_id` = '$userStateId' AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel9($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId, $userHighestEducationId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`highest_education_id` IN ('" . str_replace_last(",", "", $userHighestEducationId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel10($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId, $userJobTitleId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`jobtitle_id` IN ('" . str_replace_last(",", "", $userJobTitleId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel11($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId, $userCastId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`cast_id` IN ('" . str_replace_last(",", "", $userCastId) . "') AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel12($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId, $userReligionId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') AND `register`.`religion_id` = '$userReligionId' AND `register`.`web_id` = `users`.`id` AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
		return $query->result();
	}

	function getMatchesLevel13($userId, $userHeightFrom, $userHeightTo, $userMaritalStatusId, $userPhysicalStatusId)
	{
		$sql = "SELECT
    `register`.`reg_id`,
    `register`.`web_id`,
    `register`.`profilefor_id`,
    `register`.`gender_id`,
    `register`.`dob`,
    `register`.`mothertoungue_id`,
    `register`.`religion_id`,
    `register`.`cast_id`,
    `register`.`sub_cast`,
    `register`.`cast_bar`,
    `register`.`religion_area_id`,
    `register`.`religion_requirement`,
    `register`.`country_code`,
    `register`.`marital_status_id`,
    `register`.`height`,
    `register`.`physical_status_id`,
    `register`.`country_living_id`,
    `register`.`star_id`,
    `register`.`rassi_id`,
    `register`.`jathakam_id`,
    `register`.`native_place`,
    `register`.`landline`,
    `register`.`whatsapp`,
    `register`.`preffered_cont_type_id`,
    `register`.`contact_time`,
    `register`.`contact_name`,
    `register`.`presnt_address`,
    `register`.`permnt_address`,
    `register`.`comm_address`,
    `register`.`route_recidence`,
    `register`.`reci_landline`,
    `register`.`reci_mobile`,
    `register`.`reci_whatsapp`,
    `register`.`reci_relation_candinate`,
    `register`.`reci_contact_time`,
    `register`.`p_housename`,
    `register`.`p_country_id`,
    `register`.`p_state_id`,
    `register`.`p_city`,
    `register`.`p_district_id`,
    `register`.`p_street`,
    `register`.`p_landmark`,
    `register`.`p_pincode`,
    `register`.`c_housename`,
    `register`.`c_country_id`,
    `register`.`c_state_id`,
    `register`.`c_city`,
    `register`.`c_district_id`,
    `register`.`location`,
    `register`.`c_street`,
    `register`.`c_landmark`,
    `register`.`c_pincode`,
    `register`.`aboutme`,
    `register`.`edu_cat_id`,
    `register`.`highest_education_id`,
    `register`.`education_details`,
    `register`.`education_addition`,
    `register`.`unversity`,
    `register`.`cource`,
    `register`.`year`,
    `register`.`employedin_id`,
    `register`.`job_cat_id`,
    `register`.`jobtitle_id`,
    `register`.`pro_career`,
    `register`.`company_name`,
    `register`.`work_country`,
    `register`.`work_state`,
    `register`.`work_district`,
    `register`.`work_city`,
    `register`.`income_id`,
    `register`.`father_name`,
    `register`.`father_familyname`,
    `register`.`father_edu_cat`,
    `register`.`father_ancestary_name`,
    `register`.`father_nativeplace`,
    `register`.`mother_name`,
    `register`.`mother_familyname`,
    `register`.`mother_edu_cat`,
    `register`.`mother_ancestary_name`,
    `register`.`mother_nativeplace`,
    `register`.`mother_employedin_id`,
    `register`.`mother_job_cat`,
    `register`.`mother_job`,
    `register`.`father_employedin_id`,
    `register`.`father_job_cat`,
    `register`.`father_job`,
    `register`.`no_of_brothers_unmarried`,
    `register`.`no_of_brothersmarried`,
    `register`.`no_of_sisters_unmarried`,
    `register`.`no_of_sistersmarried`,
    `register`.`no_of_child`,
    `register`.`parents_mobile_number`,
    `register`.`family_type_id`,
    `register`.`family_status_id`,
    `register`.`family_value_id`,
    `register`.`guardian`,
    `register`.`profile_sibling`,
    `register`.`family_mother_tongue`,
    `register`.`aboutfamily`,
    `register`.`complexion_id`,
    `register`.`body_type_id`,
    `register`.`weight`,
    `register`.`bloodgroup_id`,
    `register`.`assets`,
    `register`.`language_known`,
    `register`.`drinking_id`,
    `register`.`smoking_id`,
    `register`.`diet_id`,
    `register`.`eating_id`,
    `register`.`hobbies`,
    `register`.`interests`,
    `register`.`blog`,
    `register`.`othe_social`,
    `register`.`facebook`,
    `register`.`adhar_no`,
    `register`.`registration_status`,
    `register`.`date`,
    `register`.`varification_status`,
    `register`.`profile_view`,
    `register`.`matching`,
    `register`.`staff_service`,
    `users`.`ip_address`,
    `users`.`username`,
    `users`.`password`,
    `users`.`email`,
    `users`.`activation_selector`,
    `users`.`activation_code`,
    `users`.`forgotten_password_selector`,
    `users`.`forgotten_password_code`,
    `users`.`forgotten_password_time`,
    `users`.`remember_selector`,
    `users`.`remember_code`,
    `users`.`created_on`,
    `users`.`last_login`,
    `users`.`active`,
    `users`.`first_name`,
    `users`.`last_name`,
    `users`.`company`,
    `users`.`phone`,
    `users`.`import`,
    `users`.`import_pass`,
    `users`.`registered_by`,
    `states`.`id`,
    `states`.`state`,
    `religion`.`religion_id`,
    `religion`.`religion`,
    `country`.`id`,
    `country`.`iso`,
    `country`.`name`,
    `country`.`nicename`,
    `country`.`iso3`,
    `country`.`numcode`,
    `country`.`phonecode`,
    `income`.`income_id`,
    `income`.`income`,
    `marital_status`.`marital_status_id`,
    `marital_status`.`marital_status`,
    `physical_status`.`physical_status_id`,
    `physical_status`.`physical_status`,
    `job`.`job_id`,
    `job`.`job_cat_id`,
    `job`.`job_title`,
    `education`.`education_id`,
    `education`.`edu_category`,
    `education`.`education`,
    `districts`.`id`,
    `districts`.`state_id`,
    `districts`.`district`,
    `complexion`.`complexion_id`,
    `complexion`.`complexion`,
    `body_type`.`body_type_id`,
    `body_type`.`body_type`,
    `family_status`.`family_status_id`,
    `family_status`.`family_status`,
    `cast`.`cast_id`,
    `cast`.`religion_id`,
    `cast`.`cast`,
    `documents`.`img_name`,
    `packages`.`title`
FROM
    `register`,
    `users`,
    `states`,
    `country`,
    `income`,
    `marital_status`,
    `physical_status`,
    `job`,
    `education`,
    `districts`,
    `complexion`,
    `body_type`,
    `family_status`,
    `cast`,
    `religion`,
     `documents`,
     `customer_package`,
     `packages`
WHERE
    `register`.`height` BETWEEN '$userHeightFrom' AND '$userHeightTo' 
  AND `register`.`marital_status_id` IN ('" . str_replace_last(",", "", $userMaritalStatusId) . "') 
  AND `register`.`physical_status_id` IN ('" . str_replace_last(",", "", $userPhysicalStatusId) . "') 
  AND `register`.`web_id` = `users`.`id` 
  AND `register`.`p_state_id` = `states`.`id` AND `register`.`religion_id` = `religion`.`religion_id` AND `register`.`p_country_id` = `country`.`id` AND `register`.`income_id` = `income`.`income_id` AND `register`.`marital_status_id` = `marital_status`.`marital_status_id` AND `register`.`physical_status_id` = `physical_status`.`physical_status_id` AND `register`.`jobtitle_id` = `job`.`job_id` AND `register`.`highest_education_id` = `education`.`education_id`  AND `register`.`p_district_id` = `districts`.`id` AND `register`.`complexion_id` = `complexion`.`complexion_id` AND `register`.`body_type_id` = `body_type`.`body_type_id` AND `register`.`family_status_id` = `family_status`.`family_status_id` AND `register`.`cast_id` = `cast`.`cast_id` AND `documents`.`web_id` = `users`.`id` AND `documents`.`type`= 'profile_photo' AND `customer_package`.`web_id` = `users`.`id` AND `customer_package`.`sub_id` = `packages`.`id` AND `register`.`web_id` != '$userId'  
ORDER BY
    `users`.`created_on`
DESC";
		$query = $this->db->query($sql);
//		echo $this->db->last_query();
//		exit(0);
		return $query->result();
	}
}
